# –†–µ–∑—é–º–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –¥–ª—è Multilayer

## üéØ –û–±–∑–æ—Ä

–°–æ–∑–¥–∞–Ω –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –≤–∞—à–µ–≥–æ Go –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π. –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ —Å–∏—Å—Ç–µ–º—ã.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/integration/
‚îú‚îÄ‚îÄ api_integration_test.go      # API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ database_integration_test.go # –¢–µ—Å—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ docker_integration_test.go   # Docker –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ e2e_test.go                  # End-to-end —Ç–µ—Å—Ç—ã
‚îî‚îÄ‚îÄ README.md                    # –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üß™ –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

### 1. **API Integration Tests** 
- ‚úÖ Health Check endpoint
- ‚úÖ User Registration (—É—Å–ø–µ—à–Ω–∞—è, –¥—É–±–ª–∏–∫–∞—Ç—ã, –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
- ‚úÖ User Retrieval (—É—Å–ø–µ—à–Ω–∞—è, –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ, –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ ID)
- ‚úÖ User Update (—É—Å–ø–µ—à–Ω–∞—è, –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ, –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
- ‚úÖ Complete User Workflow (–ø–æ–ª–Ω—ã–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª)

### 2. **Database Integration Tests**
- ‚úÖ Database Connection & Migration
- ‚úÖ User Repository Operations (CRUD)
- ‚úÖ User Service Integration
- ‚úÖ Database Constraints (—É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å)
- ‚úÖ Transaction Rollback
- ‚úÖ Performance Tests (–º–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ, –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å)

### 3. **Docker Integration Tests**
- ‚úÖ Container Startup & Health Check
- ‚úÖ API Integration in Container
- ‚úÖ Container Logs
- ‚úÖ Container Restart & Recovery
- ‚úÖ Resource Limits & Statistics
- ‚úÖ Network Integration
- ‚úÖ Environment Variables

### 4. **End-to-End Tests**
- ‚úÖ Complete User Lifecycle
- ‚úÖ Multiple Users Management
- ‚úÖ Error Handling & Validation
- ‚úÖ Concurrent Requests
- ‚úÖ Performance Benchmarks
- ‚úÖ Data Persistence
- ‚úÖ Invalid Request Handling

## üöÄ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞

```bash
# –í—Å–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
make test-integration

# –¢–æ–ª—å–∫–æ end-to-end —Ç–µ—Å—Ç—ã
make test-e2e

# –í—Å–µ —Ç–µ—Å—Ç—ã (unit + integration + e2e)
make test-all

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
make test-integration-cover
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –ò–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
- **In-memory SQLite** –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Ç–µ—Å—Ç–æ–≤
- **–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã** –¥–ª—è Docker —Ç–µ—Å—Ç–æ–≤
- **–°–ª—É—á–∞–π–Ω—ã–µ –ø–æ—Ä—Ç—ã** –¥–ª—è E2E —Ç–µ—Å—Ç–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** —Ä–µ—Å—É—Ä—Å–æ–≤

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **–í—Å–µ API endpoints** (POST /users, GET /users/:id, PUT /users/:id, GET /health)
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** (username, email, ID)
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** (400, 404, 500)
- **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞** (—É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)
- **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞** (Docker, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã** (in-memory –±–∞–∑–∞)
- **–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã** (–≥–æ—Ä—É—Ç–∏–Ω—ã)
- **–ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** (100+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- **–¢–∞–π–º–∞—É—Ç—ã** –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
- **API Layer**: 100% endpoints
- **Service Layer**: –í—Å–µ –±–∏–∑–Ω–µ—Å-–æ–ø–µ—Ä–∞—Ü–∏–∏
- **Repository Layer**: –í—Å–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- **Database**: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, –º–∏–≥—Ä–∞—Ü–∏–∏, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- **Infrastructure**: Docker, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –¢–∏–ø—ã –ø—Ä–æ–≤–µ—Ä–æ–∫
- **Happy Path**: –£—Å–ø–µ—à–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- **Error Path**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- **Edge Cases**: –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏
- **Performance**: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **Security**: –ò–∑–æ–ª—è—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

## üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ
- **Go 1.24+** - —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- **Testify** - assertions –∏ mocking
- **Fiber** - HTTP —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **GORM** - ORM –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ
- **Docker SDK** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
- **SQLite** - in-memory –±–∞–∑–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- **httptest** - HTTP —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## üîÑ CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### GitHub Actions
```yaml
- name: Run Integration Tests
  run: make test-integration

- name: Run E2E Tests  
  run: make test-e2e
```

### Docker –≤ CI
```yaml
- name: Build and Test
  run: |
    docker build -t multilayer-app .
    make test-integration
```

## üìà –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **–ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ** –ø—Ä–æ–±–ª–µ–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **–†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –ø–æ–≤–µ–¥–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
- **–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å** –≤ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –î–ª—è –¥–µ–ø–ª–æ—è
- **–ü—Ä–æ–≤–µ—Ä–∫–∞** Docker –æ–±—Ä–∞–∑–æ–≤
- **–í–∞–ª–∏–¥–∞—Ü–∏—è** –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- **End-to-end** –ø—Ä–æ–≤–µ—Ä–∫–∏

### –î–ª—è –∫–æ–º–∞–Ω–¥—ã
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è** —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** –ø—Ä–æ–≤–µ—Ä–æ–∫
- **–£–ø—Ä–æ—â–µ–Ω–∏–µ** –æ—Ç–ª–∞–¥–∫–∏
- **–ü–æ–≤—ã—à–µ–Ω–∏–µ** –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
1. –ó–∞–ø—É—Å–∫–∞–π—Ç–µ `make test-integration` –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `make test-e2e` –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
3. –î–æ–±–∞–≤–ª—è–π—Ç–µ –Ω–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
4. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞

### –í CI/CD
1. –í–∫–ª—é—á–∏—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤ pipeline
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±—Ä–∞–∑–æ–≤
3. –ó–∞–ø—É—Å–∫–∞–π—Ç–µ E2E —Ç–µ—Å—Ç—ã –≤ staging –æ–∫—Ä—É–∂–µ–Ω–∏–∏
4. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤

### –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
1. –†–µ–≥—É–ª—è—Ä–Ω–æ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ health checks –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
3. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
4. –û–±–Ω–æ–≤–ª—è–π—Ç–µ —Ç–µ—Å—Ç—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ API

## üîÆ –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
- **Load Testing** - –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Security Testing** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **API Versioning** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- **External Services** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

### –£–ª—É—á—à–µ–Ω–∏—è
- **Test Data Management** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- **Parallel Execution** - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- **Test Reporting** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
- **Performance Baselines** - –±–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

**–ò—Ç–æ–≥**: –°–æ–∑–¥–∞–Ω –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö - –æ—Ç API –¥–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. 